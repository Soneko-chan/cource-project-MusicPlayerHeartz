# Техническое задание: Создание музыкального приложения

**Студент:** Бочкарев Степан Константинович
**Группа:** 2307В

---

## 1.Описание проекта

### 1.1 Название приложения "Музыкальный плеер"

### 1.2 Назначение
"Музыкальный плеер - приложение,предназначенное для воспроизведения музыкальных композиций..Программа позваоляет регистрировать слушателей,создавать плейлисты,загружать,прослушивать треки и просматрицать информацию о них,оплачивать подписку."

---

## 2. Функциональные требования
### 2.1 Основные функции плеера

#### Функция 1: Импорт новых аудиозаписей в медиатеку
- **Описание:** Выбор дериктории с треками. Пользователь заходит в настройки,нажимает кнопку "Выбрать дерикторию",открывается проводник и пользователь может выбрать папку с треками,далее он нажимает выбрать и треки загружаются в базу данных.
- **Входные данные:** Путь, файлы
- **Результат:** Треки добавлены в базу данных.

#### Функция 2: Просмотр медиатеки
- **Описание:** Пользователь заходит в  медиатеку и может просматривать полный список треков, которые есть в приложении.
- **Входные данные:** Треки
- **Результат:** Открывается страница медиатеки.

#### Функция 3: Создание плейлиста
- **Описание:** Создание нового плейлиста.Пользователь открывает страницу Плейлисты,нажимает создать плейлист и новый плейлист добавляется в список.Плейлист появляется на экране и далее в него можно добавлять треки.
- **Входные данные:** Навзание плейлиста.
- **Результат:** Плейлист создан.

#### Функция 4: Редактирование плейлиста
- **Описание:** Изменение плейлиста.Пользователь выбирает "Редактировать плейлист" и может изменить название плейлиста,добавить треки.
- **Входные данные:** Название плейлиста,треки
- **Результат:** Изменённый плейлист

#### Функция 5: Прослушивание треков
**Описание:** Пользователь может прослушивать треки и переключать их(следующий,предыдущий),останавливать воспроизведение,а также изменять громоксть.
- **Входные данные:** Название трека,артист,длительность трека,volume,обложка
- **Результат:** Начинает играть трек.

## 3. Структура базы данных

### Таблица 1: Tracks
**Описание:** Основная таблица с информацией о музыкальных треках.

**Поля:**
- `TrackId` (INT, PRIMARY KEY, AUTO_INCREMENT) — уникальный идентификатор трека.
- `ArtistId` (INT, FOREIGN KEY) — ссылка на исполнителя.
- `AlbumId` (INT, FOREIGN KEY, NULLABLE) — ссылка на альбом.
- `DateCreated` (DATETIME) — дата добавления трека в базу.
- `TrackFilePath` (VARCHAR(500)) — абсолютный путь к аудиофайлу.
- `Title` (VARCHAR(255)) — название трека.
- `TrackDuration` (FLOAT) — длительность трека в секундах.
- `CoverPath` (VARCHAR(500), NULLABLE) — путь к файлу обложки.

**Связи:**
- Внешний ключ `ArtistId` ссылается на таблицу `Artists`.
- Внешний ключ `AlbumId` ссылается на таблицу `Albums`.
- Связь один-ко-многим с таблицей `PlaylistTracks` (через связующую таблицу).

### Таблица 2: Artists
**Описание:** Таблица с информацией об исполнителях.

**Поля:**
- `ArtistId` (INT, PRIMARY KEY, AUTO_INCREMENT) — уникальный идентификатор исполнителя.
- `ArtistName` (VARCHAR(255)) — имя исполнителя.

### Таблица 3: Albums
**Описание:** Таблица с информацией об альбомах.

**Поля:**
- `AlbumId` (INT, PRIMARY KEY, AUTO_INCREMENT) — уникальный идентификатор альбома.
- `ArtistId` (INT, FOREIGN KEY) — ссылка на исполнителя.
- `AlbumName` (VARCHAR(255)) — название альбома.
- `ReleaseYear` (INT, NULLABLE) — год выпуска.

**Связи:**
- Внешний ключ `ArtistId` ссылается на таблицу `Artists`.

### Таблица 4: Playlists
**Описание:** Таблица с информацией о пользовательских плейлистах.

**Поля:**
- `PlaylistId` (INT, PRIMARY KEY, AUTO_INCREMENT) — уникальный идентификатор плейлиста.
- `UserId` (INT, FOREIGN KEY) — ссылка на создателя плейлиста.
- `PlaylistName` (VARCHAR(255)) — название плейлиста.
- `PlaylistCoverPath` (VARCHAR(500), NULLABLE) — путь к изображению обложки плейлиста.
- `DateCreated` (DATETIME) — дата создания.

**Связи:**
- Внешний ключ `UserId` ссылается на таблицу `Users`.

### Таблица 5: PlaylistTracks (Связующая таблица)
**Описание:** Таблица для организации связи многие-ко-многим между плейлистами и треками.

**Поля:**
- `PlaylistId` (INT, FOREIGN KEY) — ссылка на плейлист.
- `TrackId` (INT, FOREIGN KEY) — ссылка на трек.
- `TrackOrder` (INT) — порядковый номер трека в плейлисте.
- `DateAdded` (DATETIME) — дата добавления трека в плейлист.

**Связи:**
- Составной первичный ключ (`PlaylistId`, `TrackId`).
- Внешние ключи ссылаются на таблицы `Playlists` и `Tracks`.

### Таблица 6: Users
**Описание:** Таблица с данными пользователей.

**Поля:**
- `UserId` (INT, PRIMARY KEY, AUTO_INCREMENT) — уникальный идентификатор пользователя.
- `Login` (VARCHAR(100), UNIQUE) — логин для входа.
- `PasswordHash` (VARCHAR(255)) — хэш пароля.
- `Username` (VARCHAR(255)) — отображаемое имя пользователя.
- `Email` (VARCHAR(255), NULLABLE) — электронная почта.
- `SubscriptionExpiry` (DATETIME, NULLABLE) — дата окончания подписки.

### Таблица 7: Payments
**Описание:** Таблица с историей платежей за подписку.

**Поля:**
- `PaymentId` (INT, PRIMARY KEY, AUTO_INCREMENT) — уникальный идентификатор платежа.
- `UserId` (INT, FOREIGN KEY) — ссылка на пользователя.
- `CardLastFour` (CHAR(4)) — последние 4 цифры номера карты.
- `PaymentAmount` (DECIMAL(10,2)) — сумма платежа.
- `PaymentDate` (DATETIME) — дата и время оплаты.
- `Status` (VARCHAR(50)) — статус платежа (Успешно/Ошибка).

**Связи:**
- Внешний ключ `UserId` ссылается на таблицу `Users`.

## 4. Основные формы приложения

#### Форма 1: MainWindow (Главная форма приложения)

**Назначение:** Главная форма музыкального плеера.На этой форме можно управлять воспроизведением треков(запустить,выбрать другой,изменить громкость и тд.) и пеереходить к другим элементам приложения.

**Элементы управления:** 
- ListView "ControlsListView" - Боковая панель с кнопками для переключения между страницами
- TextBlock "TrackTitleTextBlock" - Поле с названием трека,который играет в данный момент
- Frame "MainFrame"- Контейнер для страниц навигации
- Slider "VolumeSlider" - Ползунок для управления громкостью
- Slider "TrackDurationSlider" - Ползунок для управления длительностью трека

**Действия:**
- Кнопка "Регулировка громоксти" - при нажатии на кнопку появляется ползунок, который можно перемещавть вверх или вниз для извенения громоксти
- Кнопка "Следующий трек" - заканчивает проигрывание текущего трека и зарускает следующий трек в базе данных
- Кнопка "Предыдущий трек" - заканчивает проигрываение текущего трека и запускает предыдущий трек из базы данных
- Кнопка "Повтор" - включает повтор текущего трека пока повтор не будет выключен
- Кнопка "Главная" переход к главной странице приложения,если главная страница уже открыта ничего не меняется
- Кнопка "Плейлисты" - переход к странцие с плейлистами, где можно создавать и изменять плейлисты,а также добавлять в них треки.
- Кнопка "Библиотека" - переход к библиотеке со всеми треками в базе данных,также сюда можно добавлять свои треки
- Кнопка "Настройки" - переход к странице с настройками для изменения темы приложения,выбора директории и просмотра информации о приложении
- Кнопка "Подписка" - переход к окну оплаты подписки, где нужно ввести данные карты для оплаты и оплатить подписку.

#### Форма 2: MainPlaylistsPage

**Назначение:** Страница с плейлистами плеера.На данной форме можно создавать плейлисты,изменять их внешний вид и добавлять различные треки,а также прослушивать треки.

**Элементы управления:**
- TextBlock "PlaylistsPageTitle" - Поле с названием страницы.
- ListBox "PlaylistsListBox" - список со всеми плейлистами,который можно дополнять создавая новые плейлисты

**Действия:**
- Кнопка "Новый плейлист" - создаёт новый плейлист и открывает его страницу
- Кнопка "Перейти к плейлисту" - откроется страница выбранного плейлиста для изменения внешнего вида,добавления треков и прослушивания плейлиста.

#### Форма 3: PlaylistPage

**Назначение:** Страница плейлиста для изменения плейлиста,добавления и прослшуивания треков из плейлиста.

**Элементы управления:**
- TextBlock "PlaylistTitle" - поле с названием плейлиста
- ListBox "TracksListbox" - список с треками

**Действия:**
- Кнопка "Добавить трек" - открывает страницу со всеми треками и выбранный трек добавляет в плейлист

#### Форма 4: MediatekaPage

**Назначение:** Страница со всеми треками в базе данных приложения,предназначенная для просмотра их просмотра и прослушивания.

**Элементы управления:**
- TextBlock "MediatekaTitle" - Поле с названием "Медиатека".
- ListBox "MediatekaListBox" - список со всеми треками в базе данных приложения

**Действия:**
- При нажатии на трек он начинает проигрываться

#### Форма 5: SettingsPage

**Назначение:** Страница с настройками приложения,где можно добавить директорию со своими треками и изменить внешний вид приложения.

**Элементы управления:**
- TextBlock "SettingsTitle" - Поле с названием "Настрйоки".
- TextBlock "FileDirectory" - Поле с путём к директории треков
- ComboBox "Theme" - Список с темами доступными в приложении и которые можно выбрать при нажатии на них

**Действия:**
- Кнопка "Выбрать директорию" - открывается файловый менеджер и м ожно выбрать путь к папке с треками

#### Форма 6: PayWindow

**Назначение:** Форма для выбора тарифа и оплаты подписки.

**Элементы управления:**
- TextBox "CardNumberTextBox" - Поле для ввода номера карты пользователя
- TextBox "ExpiryCardDateTextBox" - Поле для ввода даты с карточки
- TextBox "CVVTextBox" - Поле для ввода специального коды карточки
-

**Действия:**
- Кнопка "Оплатить подписку" - введённые данные проверяются и если нет ошибок, то выводится сообщение, что оплата прошла успешно и окно с оплатой закрывается.
- Кнопка "Отмена" - отменяет покупку и закрывает окно платежа.

#### Форма 7: LoginWindow

**Назначение:** Форма для входа в аккаунт пользователя.

**Элементы управления:**
- TextBox "LoginTextBox" - Поле для ввода номера карты пользователя
- TextBox "PasswordTextBox" - Поле для ввода даты с карточки

**Действия:**
- Кнопка "Вход" - данные пользователя проверяются и если они есть в базе данных пользователь может войти,если нет выдаётся ошибка
- Кнопка "Закрыть" - закрывает форму для входа и возвращается на главный экран

## 5.Схема переходов между формами

### Схема навигации

#### Запуск приложения
**Запуск** → 'MainWindow' (Главная форма плеера)

#### Из MainWindow
**Навигация через боковую панель:**

     - Кнопка "Главная" → MainPage в MainFrame (если не открыта)
     - Кнопка "Плейлисты" → MainPlaylistsPage в MainFrame
     - Кнопка "Библиотека" → MediatekaPage в MainFrame
     - Кнопка "Настройки" → SettingsPage в MainFrame
     - Кнопка "Подписка" → PayWindow в MainFrame
     - Кнопка 'Войти' → LoginWindow в MainFrame

**Управление воспроизведением:**

     - Кнопка "Регулировка громкости" → отображение/скрытие VolumeSlider
     - Кнопка "Следующий трек" → переход к следующему треку в базе данных
     - Кнопка "Предыдущий трек" → переход к предыдущему треку в базе данных
     - Кнопка "Повтор" → включение/выключение повтора текущего трека
     - Slider "VolumeSlider" → изменение громкости воспроизведения
     - Slider "TrackDurationSlider" → перемотка текущего трека

#### Из MediatekaPage
    - Выбор трека в MediatekaListBox → начало воспроизведения выбранного трека
    
#### Из MainPlaylistsPage
    - Кнопка "Новый плейлист" → создание плейлиста → открытие PlaylistPage для нового плейлиста
    - Кнопка "Перейти к плейлисту" (выбран плейлист в PlaylistsListBox) → PlaylistPage для выбранного плейлиста

#### Из PlaylistPage
    - Кнопка "Добавить трек" → открытие MediatekaPage в режиме выбора → выбор трека → добавление в плейлист → возврат на PlaylistPage
    - Выбор трека в TracksListbox → начало воспроизведения выбранного трека

#### Из SettingsPage
    - Кнопка "Выбрать директорию" → открытие файлового менеджера → выбор папки → обновление FileDirectory
    - Выбор темы в Theme ComboBox → немедленное применение выбранной темы оформления

#### Из PayWindow
    - Проверка данных карты → Успех → сообщение об успешной оплате → закрытие PayWindow → возврат на предыдущую страницу
    - Ошибка → сообщение об ошибке → остаёмся на PayWindow
    - Кнопка "Отмена" → закрытие PayWindow без оплаты → возврат на предыдущую страницу

#### Из LoginWindow
    - Ввод данных → Проверка данных пользователя  → Успех → Вход в аккаунт → Закрытие LoginWindow → Возврат на предыдущую страницу
    - Ошибка → Сообщение об ошибке в введённых данных → Остаёмся на LoginWindow
    - Кнопка "Закрыть" → закрытие LoginWindow → Возврат на предыдущую страницу
